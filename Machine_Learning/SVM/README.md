# 手动实现SVM

该项目使用 Python 和 Numpy 实现了支持向量机（SVM）分类器，用于二分类任务。

## 概述

支持向量机（SVM）分类器是一种强大的机器学习算法，用于分类任务。它通过找到在特征空间中分隔类别的最优超平面来工作，以达到最大化间隔的目的。

在这个项目中，我们实现了一个自定义的 SVM 分类器，并使用一个合成数据集将其性能与 Scikit-Learn 提供的 SVM 分类器进行了比较。

## 功能特点

- 自定义 SVM 分类器的实现，支持不同的核函数（线性、多项式、径向基函数）。
- 将自定义 SVM 分类器与 Scikit-Learn 的 SVM 分类器进行了比较。
- 使用合成数据集评估分类准确率。

## 参数影响
**C参数控制了 SVM 模型对误分类样本的惩罚程度**
- 较大的 C 值会导致模型对误分类样本的惩罚增加，更强调分类的准确性，可能会导致模型在训练集上的拟合程度较高，但泛化能力较差，容易发生过拟合。
- 较小的 C 值会减小对误分类样本的惩罚，更强调模型的泛化能力，可能会导致模型在训练集上的拟合程度较低，但更具有泛化能力，对未见过的数据集更具有适应性。

**Gamma 参数控制了核函数（如 RBF 核）的影响范围**
- 较大的 gamma 值会使得核函数的影响范围减小，使得模型更加关注局部的数据点，可能导致模型在训练集上过拟合，对噪声敏感，泛化能力较差。
- 较小的 gamma 值会使得核函数的影响范围增大，使得模型更加关注全局的数据分布，可能导致模型在训练集上拟合程度较低，但更具有泛化能力，对未见过的数据集更具有适应性。
## 结果展示
### 二分类(Binary classification)
*由于Scikit-Learn的SVM分类器中采用的交叉验证方法选取超参数，而且采取了一些优化算法，因此选取手动调优的参数与调用的Scikit-Learn的SVM交叉验证得到的参数进行效果比较*

```
参数设置：
kernel = 'rbf'
C = 2.5
gamma = 1
```

![](https://cdn.jsdelivr.net/gh/SparKgod1/img/svm_result1.png)

手写正确率：98.00%
调包正确率：98.00%

选取分布更为密集的数据点集进行对比

```
参数设置：
kernel = 'rbf'
C = 2
gamma = 1
```
![](https://cdn.jsdelivr.net/gh/SparKgod1/img/svm_result2.png)

手写正确率：93.00%
调包正确率：89.50%

可以看出，由于 Scikit-Learn 的 SVM 分类器在边界搜索方面采取的优化算法，它能够找到更好的分类界面，从而提高了模型的性能和泛化能力。
### 问题分析 （2024.03.22）
大多数情况下，手写的支持向量机（SVM）算法与 Scikit-Learn 中的 SVC 在准确率上几乎具有相同水平。然而，在处理标签设置为1/0的情况下可能会出现数据偏移，导致一个类别的错误分类点无法被忽略。这种情况下，无论如何调整参数都难以避免这种偏移现象。

![](https://cdn.jsdelivr.net/gh/SparKgod1/img/prob_1.png)

手写正确率：51.50%
调包正确率：93.00%

如果label的设置改成1/-1时，增大了不同类别数据标签之间的间距，避免了数据权重偏移的情况，便可以在交叉程度较大的数据点分类中取得更好的成果
```
参数设置：
kernel = 'rbf'
C = 0.8
gamma = 1.2
```

![](https://cdn.jsdelivr.net/gh/SparKgod1/img/noprob_1.png)

手写正确率：92.50%
调包正确率：93.00%

### 在minist数据集上进行一对多(OvA, One-vs-All classification)分类测试性能

训练十个 SVM 分类器，每个分类器对应一个数字类别。然后将当前类别标记为 1，其他类别标记为 -1，将数据集转换成二元分类任务。

```
D:\miniconda3\envs\gpu\python.exe "C:\Users\LENOVO\PycharmProjects\111\ML\Supervised Learning\My_SVM\One-vs-All classification.py" 
数字0的正确率为1.0
数字1的正确率为0.9972222222222222
数字2的正确率为1.0
数字3的正确率为0.9972222222222222
数字4的正确率为1.0
数字5的正确率为0.9972222222222222
数字6的正确率为0.9944444444444445
数字7的正确率为0.9972222222222222
数字8的正确率为0.9888888888888889
数字9的正确率为0.9916666666666667
在测试集上的正确率为: 0.97

Process finished with exit code 0
```
由此看出我们手动实现的SVM在高维数据上的分类性能还是非常可观的

ps：由于数据集比较大训练时间不短于一个小时，因此我将训练好的文件放在```/My_SVM/classifiers```中，每个类别对应的分类器为```classifier_{class_label}.pkl```